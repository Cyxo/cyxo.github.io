<!doctype html><html lang=en-us><head><title>THCon21 - TUR-ROX-Z |
Cyxo's Tech Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="A video game reverse engineering challenge from THCon21
    "><meta property="og:title" content="THCon21 - TUR-ROX-Z"><meta property="og:description" content="A video game reverse engineering challenge from THCon21"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.cyxo.cf/thcon-2021-ctf-write-ups/tur-rox-z/"><meta property="article:section" content="THCon-2021-CTF-Write-Ups"><meta property="article:published_time" content="2021-06-14T16:29:03+02:00"><meta property="article:modified_time" content="2021-06-14T16:29:03+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="THCon21 - TUR-ROX-Z"><meta name=twitter:description content="A video game reverse engineering challenge from THCon21"><meta itemprop=name content="THCon21 - TUR-ROX-Z"><meta itemprop=description content="A video game reverse engineering challenge from THCon21"><meta itemprop=datePublished content="2021-06-14T16:29:03+02:00"><meta itemprop=dateModified content="2021-06-14T16:29:03+02:00"><meta itemprop=wordCount content="1165"><meta itemprop=keywords content="reverse engineering,video game,"><link rel=canonical href=https://blog.cyxo.cf/thcon-2021-ctf-write-ups/tur-rox-z/><link rel=icon type=image/png href=https://blog.cyxo.cf/image/favicon.ico><link rel=stylesheet href=/css/font-awesome.min.css><link rel=stylesheet href=/css/bulma.min.css><script src=/js/ramium.js></script><link rel=stylesheet href=/css/ramium.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><nav class="navbar is-dark" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><strong>Cyxo's Tech Blog</strong></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=/>Home</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>This Blog</a><div class=navbar-dropdown><a class=navbar-item href=/tags/>All Tags</a>
<a class=navbar-item href=/sections/>All Sections</a>
<a class=navbar-item href=/posts/>All Posts</a></div></div><a class=navbar-item href=/author/>Author</a></div><div class=navbar-end><a class="navbar-item navgithub" href=https://github.com/Cyxo/ target=_blank><i class="fa fa-github fa-2x"></i></a></div></div></nav><div class="columns is-centered"><div id=page-body class="column is-7"><div class="content blog"><h1>THCon21 - TUR-ROX-Z</h1><div id=infobar class="level is-mobile"><div class=level-left><div class=level-item><p class="subtitle info date">Jun 14, 2021</p></div><div class=level-item><p class="subtitle info">7 mins read</p></div></div><div class="level-right is-hidden-touch"><div class=tags><a class="tag is-dark is-rounded" href=/tags/reverse-engineering>Reverse Engineering</a>
<a class="tag is-dark is-rounded" href=/tags/video-game>Video Game</a></div></div></div><div class="tags is-hidden-desktop"><a class="tag is-dark is-rounded" href=/tags/reverse-engineering>Reverse engineering</a>
<a class="tag is-dark is-rounded" href=/tags/video-game>Video game</a></div><div class=blog-text><h1 id=thcon21---tur-rox-z>THCon21 - TUR-ROX-Z</h1><p><a href=../>Go back to write-ups list</a></p><blockquote><p><strong>Category:</strong> Reverse</p><p><strong>Creator:</strong> Réchèr</p><p><strong>Description:</strong></p><p>A journey in Turing-approxi-complete video games, chapter &ldquo;Z&rdquo;.</p><p>&ldquo;ZZT&rdquo; ? What is that strange file extension ? It may be something old. If it&rsquo;s old, there is a MUSEUM about it. Whatever it is, I suppose it has nothing to do with the Riemann ZETA function.</p><p><strong>Attachments:</strong></p><ul><li><a href=/files/thcon21/THCON21Z.ZZT>THCON21Z.ZZT</a></li></ul></blockquote><h2 id=first-step-discovery>First step: discovery</h2><p>I had indeed never seen the file extension ZZT before, so I did some research using the hints in the challenge description: &ldquo;zzt museum zeta&rdquo;, which led me to <a href=https://museumofzzt.com/zeta>a ZZT player called Zeta</a>, along with a detailed tutorial on how to run and even edit ZZT files.</p><p>So I launched the ZZT world and started searching around for something interesting.</p><p><img src=/image/thcon21/visit.gif alt="Visiting the world"></p><p>The first thing we get to see is the flag format, with the first letter of the flag, which is sweet but not enough. Going to the south-west, we see a flowchart explaining how to solve the challenge (but we already went through most of these steps). And at the north of the world, there is the main puzzle room, which will be our main interest for the rest of this write-up.</p><h2 id=next-step-understanding-the-puzzle>Next step: understanding the puzzle</h2><p>We can open the ZZT world using KevEdit and switch to the <code>third board</code>:</p><p><img src=/image/thcon21/zzt_editor.png alt="Third board"></p><p>ZZT allows the map maker to script the behavior of the map using custom Objects and a scripting language similar to Basic.
This language is <a href=https://apocalyptech.com/games/zzt/manual/langref.html>documented here</a></p><p>In this map there are 14 scriptable objects of interest:</p><ul><li>The black face <code>☺</code> at the bottom left which checks if you solved the puzzle</li><li>The white star <code>*</code> on the left which resets the level</li><li>The green exclamation mark <code>!</code> which is the core of the green puzzle (also called &ldquo;part A&rdquo;)</li><li>The upside down exclamation marks <code>¡</code> which are sliders for the green, red and blue puzzles</li><li>The lawless invisible object at the beginning of the red path, which is the core of the red puzzle (&ldquo;part B&rdquo;)</li><li>And finally, the question marks <code>?</code> which are unattainable and are here for debugging purposes</li></ul><p>The first thing I did, for more comfort in solving this challenge, was to paint the walls of the invisible path in white so I could see it in game, change the character of the lawless invisible object to an <code>A</code> (instead of space), and remove the walls blocking the debugging objects.</p><p><img src=/image/thcon21/zzt_edited.png alt="Third board edited"></p><p>Now I&rsquo;m going to explain each of the puzzles ordered by difficulty (because in my opinion, part A was the most difficult to understand).</p><h2 id=part-b---the-red-puzzle>Part B - The red puzzle</h2><p>By pressing <code>[Enter]</code> on a red <code>¡</code>, you get a menu and where you can edit the script of the object.</p><p>Here is the script for the leftmost one:</p><p><img src=/image/thcon21/red_left.png alt="Red left"></p><p>And the rightmost one:</p><p><img src=/image/thcon21/red_right.png alt="Red right"></p><p>The <code>#send</code> command jumps to a label. So <code>#send Invisible:lblGoUp</code> jumps to the label <code>:lblGoUp</code> in the script of <code>@Invisible</code>. I think you&rsquo;re smart enough to understand what these labels do. So my intuition was that you need to push the no-longer-invisible guy to the end of its path. That&rsquo;s one time left, four times right, two times left, two times right. The resulting code for the red puzzle is <code>47</code>. We can check the puzzle is solved by going to the red question mark:</p><p><img src=/image/thcon21/red_solved.png alt="Red solved"></p><p><em>Note: the line <code>#if blocked n then lblFailZ</code> just checks if you pushed the slider to the end of the track.</em></p><h2 id=part-c---the-blue-puzzle>Part C - The blue puzzle</h2><p>Here are the scripts for the left and right blue <code>¡</code>:</p><p><img src=/image/thcon21/blue_left.png alt="Blue left"> <img src=/image/thcon21/blue_right.png alt="Blue right"></p><p><em>Note: the lines starting with <code>'</code> are comments, so the messages on these lines aren&rsquo;t displayed by default.</em></p><p>So this one is a bit more complicated. The left slider gives us one gem everytime we push it.</p><p>Something we can see as well is the <code>flag5Once</code> flag. It will make you fail if you push the left slider <em>after</em> pushing the right one. So once you&rsquo;ve pushed the right one, you can&rsquo;t give yourself more gems.</p><p>As for the right one, we have to look at the <code>#zap</code> command. According to the documentation, this command disables the first occurence of a chosen label. In this case, this implies that the first time you push the right slider, it will try to take 4 gems from you. Then the next time, it will only try to take one gem at a time.</p><p>Now let&rsquo;s look at the documentation for the <code>#take</code> command. It tries to take a certain amount of gems from the player, and jumps to the specified label if it fails (ie. if the player doesn&rsquo;t have enough gems). So here, we need to succeed in taking 4 gems to avoid <code>:lblPoor</code> which makes us fail. Then we need to fail taking one more gem to jump to <code>:lblNotRich</code> and set <code>flagOkC1</code>.</p><p>In the end, we need to push the left slider 4 times, then the right slider 1 time (if we push it more, it goes to a third <code>:touch</code> which makes us fail as well), which gives us the code <code>53</code> for the blue puzzle.</p><h2 id=part-a---the-green-puzzle>Part A - The green puzzle</h2><p>Here are the scripts for the left and right green <code>¡</code>:</p><p><img src=/image/thcon21/green_left.png alt="Green left"> <img src=/image/thcon21/green_right.png alt="Green right"></p><p>Again, there is a flag to make sure that you don&rsquo;t push the right slider after the left one.</p><p>Looking at the documentation for the <code>#restore</code>, it re-enables a label disabled by the <code>#zap</code> command.
It doesn&rsquo;t look like much, so we have to dig in the final verification to understand what this does. Here is the beginning of the verification script:</p><p><img src=/image/thcon21/glob_check.png alt=GlobCheck></p><p>As you can see, it will jump to <code>:lblMulti</code> in the entity <code>@Checker12</code> (which is the green <code>!</code> at the top). Here is its script:</p><p><img src=/image/thcon21/checker12.png alt=Checker12></p><p>So by default, the global checker will jump to the first <code>:lblMulti</code> which sets <code>flagOkA1</code> (yay!) and then jumps itself to the second one which sets <code>flagFailA</code> (nooooo 😢).</p><p>If we use the first slider seven times, we will zap enough <code>:lblMulti</code> to make the global checker jump where it sets <code>flagOkA2</code>. But then we won&rsquo;t have the <code>flagOkA1</code> set anymore.</p><p>Fortunately, the <code>#restore</code> commands restores the first label that you&rsquo;ve zapped (not the most recent one). So if we push the second slider one time, it will restore the label that sets <code>flagOkA1</code>, then jump all the way to the seventh <code>:lblMulti</code> (because all the other ones are still zapped) and set <code>flagOkA2</code>. This gives us the code <code>82</code> for the green puzzle.</p><h2 id=the-end>The End</h2><p>Now going to the global checker, we get to hear a nice victory music along with this message:</p><p><img src=/image/thcon21/end_message.png alt=Victory></p><p>So the flag is THCon21{Z<green>82</green><red>47</red><blue>53</blue>}.</p><p>This was a very mind-bending challenge but it was nice when we were finally able to understand all the little scripts and figure out the answer. Special thanks to the author who visibly put a lot of effort in creating this challenge.</p><p>Now if you want to see more about scripted puzzles, you can continue to this challenge&rsquo;s brother: <a href=..//tur-rox-y>TUR-ROX-Y</a>.</p><p>Or you can <a href=../>go back to write-ups list</a>.</p></div></div><div id=social-media-share class=has-text-centered><p><i>Sharing is caring!</i></p><br><div class=share-buttons><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" onclick="return socialMediaPopUp(this.href,'',500,500),!1" title="Share on Facebook. Opens in a new window."><img src=/img/icons/45px/facebook.png></a>
<a href="https://twitter.com/intent/tweet?text=THCon21%20-%20TUR-ROX-Z&url=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" onclick="return socialMediaPopUp(this.href,'',500,500),!1" title="Share on Twitter. Opens in a new window."><img src=/img/icons/45px/twitter.png></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" onclick="return socialMediaPopUp(this.href,'',900,500),!1" title="Share on Reddit. Opens in a new window."><img src=/img/icons/45px/reddit.png></a>
<a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" onclick="return socialMediaPopUp(this.href,'',900,500),!1" title="Share on Pinterest. Opens in a new window."><img src=/img/icons/45px/pinterest.png></a>
<a href="http://www.tumblr.com/share/link?url=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" onclick="return socialMediaPopUp(this.href,'',900,500),!1" title="Share on Tumblr. Opens in a new window."><img src=/img/icons/45px/tumblr.png></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f
			&title=THCon21%20-%20TUR-ROX-Z&summary=THCon21%20-%20TUR-ROX-Z%20Go%20back%20to%20write-ups%20list%0a%20Category%3a%20Reverse%0aCreator%3a%20R%c3%a9ch%c3%a8r%0aDescription%3a%0aA%20journey%20in%20Turing-approxi-complete%20video%20games%2c%20chapter%20%26ldquo%3bZ%26rdquo%3b.%0a%26ldquo%3bZZT%26rdquo%3b%20%3f%20What%20is%20that%20strange%20file%20extension%20%3f%20It%20may%20be%20something%20old.%20If%20it%26rsquo%3bs%20old%2c%20there%20is%20a%20MUSEUM%20about%20it.&source=rafed123.github.io" onclick="return socialMediaPopUp(this.href,'',900,500),!1" title="Share on LinkedIn. Opens in a new window."><img src=/img/icons/45px/linkedin.png></a>
<a href="mailto:?subject=THCon21%20-%20TUR-ROX-Z&body=Check out this site https%3a%2f%2fblog.cyxo.cf%2fthcon-2021-ctf-write-ups%2ftur-rox-z%2f" title="Share via Email. Opens in a new window."><img src=/img/icons/45px/mail.png></a></div></div><br><div id=disqus_thread></div><script type=text/javascript>(function(){var a,b;if(window.location.hostname=="localhost")return;a=document.createElement('script'),a.type='text/javascript',a.async=!0,b='',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><footer class="footer has-background-dark"><div class="content has-text-centered has-text-white"><p>© 2020 Ramium. Powered by
<a class=has-text-light href=https://github.com/gohugoio/hugo target=_blank>Hugo</a>. Theme
<a class=has-text-light href=https://github.com/rafed123/ramium/ target=_blank>Ramium.</a></p></div></footer></body></html>