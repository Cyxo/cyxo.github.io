<!doctype html><html lang=en-us><head><title>üá´üá∑ PWNME - Reverser Don't Like Rustacer |
Cyxo's Tech Blog</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="Reverse d'un binaire en Rust
    "><meta property="og:title" content="üá´üá∑ PWNME - Reverser don't like Rustacer"><meta property="og:description" content="Reverse d'un binaire en Rust"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.cyxo.cf/pwnme-2022/rustacer/"><meta property="article:section" content="PWNME-2022"><meta property="article:published_time" content="2022-07-08T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="üá´üá∑ PWNME - Reverser don't like Rustacer"><meta name=twitter:description content="Reverse d'un binaire en Rust"><meta itemprop=name content="üá´üá∑ PWNME - Reverser don't like Rustacer"><meta itemprop=description content="Reverse d'un binaire en Rust"><meta itemprop=datePublished content="2022-07-08T00:00:00+00:00"><meta itemprop=dateModified content="2022-07-08T00:00:00+00:00"><meta itemprop=wordCount content="300"><meta itemprop=keywords content="reverse engineering,"><link rel=canonical href=https://blog.cyxo.cf/pwnme-2022/rustacer/><link rel=icon type=image/png href=https://blog.cyxo.cf/image/favicon.ico><link rel=stylesheet href=/css/font-awesome.min.css><link rel=stylesheet href=/css/bulma.min.css><script src=/js/ramium.js></script>
<link rel=stylesheet href=/css/ramium.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><nav class="navbar is-dark" role=navigation aria-label="main navigation"><div class=navbar-brand><a class=navbar-item href=/><strong>Cyxo's Tech Blog</strong></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=navbarBasicExample><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a></div><div id=navbarBasicExample class=navbar-menu><div class=navbar-start><a class=navbar-item href=/>Home</a><div class="navbar-item has-dropdown is-hoverable"><a class=navbar-link>This Blog</a><div class=navbar-dropdown><a class=navbar-item href=/tags/>All Tags</a>
<a class=navbar-item href=/sections/>All Sections</a>
<a class=navbar-item href=/posts/>All Posts</a></div></div><a class=navbar-item href=/author/>Author</a></div><div class=navbar-end><a class=navbar-item title="RSS Feed" href=/index.xml target=_blank><i class="fa fa-rss-square fa-2x"></i></a>
<a class="navbar-item navgithub" title=Github href=https://github.com/Cyxo/ target=_blank><i class="fa fa-github fa-2x"></i></a></div></div></nav><div class="columns is-centered"><div id=page-body class="column is-7"><div class="content blog"><h1>üá´üá∑ PWNME - Reverser Don't Like Rustacer</h1><div id=infobar class="level is-mobile"><div class=level-left><div class=level-item><p class="subtitle info date">Jul 8, 2022</p></div><div class=level-item><p class="subtitle info">2 mins read</p></div></div><div class="level-right is-hidden-touch"><div class=tags><a class="tag is-dark is-rounded" href=/tags/reverse-engineering>Reverse Engineering</a></div></div></div><div class="tags is-hidden-desktop"><a class="tag is-dark is-rounded" href=/tags/reverse-engineering>Reverse engineering</a></div><div class=blog-text><p><a href=../>Go back to write-ups list</a></p><p><em>This write-up is in French because it&rsquo;s a French CTF, sowwy</em></p><blockquote><p><strong>Category:</strong> Reverse</p><p><strong>Creator:</strong> Bryton</p><p><strong>Description:</strong></p><p>Simpler than it seems</p><p>Flag format: PWNME{flag}</p><p><strong>Attachments:</strong></p><ul><li><a href=/files/pwnme22/Reverser.exe>Reverser.exe</a></li></ul></blockquote><p>Ce programme est un crack-me ordinaire o√π l&rsquo;on doit entrer un mot de passe pour obtenir le flag.</p><p><img src=/image/pwnme22/rust_usage.png alt="Rustacer usage"></p><p>Cependant, lorsqu&rsquo;on l&rsquo;ouvre dans un d√©sassembleur, on constate qu&rsquo;en plus d&rsquo;√™tre √©crit en Rust (comme indiqu√© par le titre du chall), le programme a √©t√© compil√© sans les symboles : impossible donc de trouver main ou encore le nom d&rsquo;une fonction qui v√©rifie notre mot de passe. On va donc devoir ruser üòè</p><p>J&rsquo;ai commenc√© par chercher l&rsquo;adresse de la cha√Æne de caract√®res <code>"Usage: [...]"</code> ainsi que son utilisation dans le binaire :</p><p><img src=/image/pwnme22/rust_str.png alt="Rustacer string"></p><p>Cela nous m√®ne vers une grosse fonction, qui d&rsquo;ailleurs n&rsquo;est pas bien analys√©e par IDA. Mais le plus gros de la v√©rification est quand m√™me tout √† fait compr√©hensible. On a d&rsquo;abord une premi√®re partie qui v√©rifie la longueur du mot de passe entr√© :</p><p><img src=/image/pwnme22/rust_len.png alt="Password length"></p><p>On sait donc que la longueur doit √™tre de 12. Puis une deuxi√®me partie un peu plus longue qui ex√©cute une fonction de v√©rification et qui en fonction du r√©sultat affiche &ldquo;Incorrect flag&rdquo; ou appelle une autre fonction qui calcule puis affiche le flag.</p><p><img src=/image/pwnme22/rust_cmp.png alt=Comparison></p><p>Attendez&mldr; calcule puis affiche le flag ? Le plus simple donc, plut√¥t que de se perdre de le d√©dale de fonctions sans nom, ce serait de modifier le flux d&rsquo;ex√©cution du programme pour inverser la comparaison, et ainsi passer √† l&rsquo;affichage du flag lorsque notre mot de passe est faux !</p><p>On va donc patcher le binaire pour remplacer l&rsquo;instruction <code>jnz</code> par son oppos√©e : <code>jz</code>.</p><p><img src=/image/pwnme22/rust_patch.png alt=Patch></p><p>Et ainsi, lorsqu&rsquo;on lance le programme avec une string de longueur 12 en argument, on obtient le flag !</p><p><img src=/image/pwnme22/rust_flag.png alt=Flag></p><p><a href=../>Go back to write-ups list</a></p></div></div><div id=social-media-share class=has-text-centered><p><i>Sharing is caring!</i></p><br><div class=share-buttons><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" onclick='return socialMediaPopUp(this.href,"",500,500),!1' title="Share on Facebook. Opens in a new window."><img src=/img/icons/45px/facebook.png></a>
<a href="https://twitter.com/intent/tweet?text=%f0%9f%87%ab%f0%9f%87%b7%20PWNME%20-%20Reverser%20don%27t%20like%20Rustacer&url=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" onclick='return socialMediaPopUp(this.href,"",500,500),!1' title="Share on Twitter. Opens in a new window."><img src=/img/icons/45px/twitter.png></a>
<a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" onclick='return socialMediaPopUp(this.href,"",900,500),!1' title="Share on Reddit. Opens in a new window."><img src=/img/icons/45px/reddit.png></a>
<a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" onclick='return socialMediaPopUp(this.href,"",900,500),!1' title="Share on Pinterest. Opens in a new window."><img src=/img/icons/45px/pinterest.png></a>
<a href="http://www.tumblr.com/share/link?url=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" onclick='return socialMediaPopUp(this.href,"",900,500),!1' title="Share on Tumblr. Opens in a new window."><img src=/img/icons/45px/tumblr.png></a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f
			&title=%f0%9f%87%ab%f0%9f%87%b7%20PWNME%20-%20Reverser%20don%27t%20like%20Rustacer&summary=Go%20back%20to%20write-ups%20list%0aThis%20write-up%20is%20in%20French%20because%20it%26rsquo%3bs%20a%20French%20CTF%2c%20sowwy%0aCategory%3a%20Reverse%0aCreator%3a%20Bryton%0aDescription%3a%0aSimpler%20than%20it%20seems%0aFlag%20format%3a%20PWNME%7bflag%7d%0aAttachments%3a%0aReverser.exe%20Ce%20programme%20est%20un%20crack-me%20ordinaire%20o%c3%b9%20l%26rsquo%3bon%20doit%20entrer%20un%20mot%20de%20passe%20pour%20obtenir%20le%20flag.&source=rafed123.github.io" onclick='return socialMediaPopUp(this.href,"",900,500),!1' title="Share on LinkedIn. Opens in a new window."><img src=/img/icons/45px/linkedin.png></a>
<a href="mailto:?subject=%f0%9f%87%ab%f0%9f%87%b7%20PWNME%20-%20Reverser%20don%27t%20like%20Rustacer&body=Check out this site https%3a%2f%2fblog.cyxo.cf%2fpwnme-2022%2frustacer%2f" title="Share via Email. Opens in a new window."><img src=/img/icons/45px/mail.png></a></div></div><br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><footer class="footer has-background-dark"><div class="content has-text-centered has-text-white"><p>¬© 2020 Ramium. Powered by
<a class=has-text-light href=https://github.com/gohugoio/hugo target=_blank>Hugo</a>. Theme
<a class=has-text-light href=https://github.com/rafed123/ramium/ target=_blank>Ramium.</a></p></div></footer></body></html>